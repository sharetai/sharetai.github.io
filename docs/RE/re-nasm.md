---
layout: default
title: NASM
nav_order: 12
parent: RE
---

# Netwide Assembler
{: .no_toc }

Netwide Assembler là một trình biên dịch và dịch ngược cho kiến ​​trúc Intel x86
{: .fs-6 .fw-300 }

_Nguồn tham khảo: [https://www.tutorialspoint.com/assembly_programming/](https://www.tutorialspoint.com/assembly_programming/)_

---

## TABLE OF CONTENTS
{: .no_toc .text-delta }

1. TOC
{:toc}

---

Trang này sẽ trình bày ngoài phần code tham khảo từ tutorial, sẽ có thêm phần debug trực tiếp chương trình. Mục đích tạo ra góc nhìn rõ ràng hành vi của các thành phần trong bộ nhớ của một tiến trình đang chạy.

## Bố cục bộ nhớ của một tiến trình

```
 ______________________________ 
|                              | ← low memory
|          text (code)         |
|______________________________|
|                              |
|      data (initialized)      |
|______________________________|
|                              |
|      bss (uninitialized)     |
|______________________________|
|                              |
|             heap             |
|------------------------------|
|              ↓               |
|                              |
|                              | 
|              ↑               |
|------------------------------|
|            stack             |
|______________________________| ← high memory
```

## hello.asm

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start  	;must be declared for linker (ld)
	
_start:	            	;tells linker entry point
   mov	edx,len     	;message length
   mov	ecx,msg    	;message to write
   mov	ebx,1    	;file descriptor (stdout)
   mov	eax,4     	;system call number (sys_write)
   int	0x80        	;call kernel
	
   mov	eax,1       	;system call number (sys_exit)
   int	0x80        	;call kernel

section	.data
msg db 'Hello, world!', 0xa  	;string to be printed
len equ $ - msg     		;length of the string
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 hello.asm
ld -m elf_i386 -o hello hello.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q hello
Reading symbols from hello...
(No debugging symbols found in hello)
Error while writing index for `/root/box/hello': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
...
gef➤  disassemble /r _start,+28
Dump of assembler code from 0x8049000 to 0x804901c:
=> 0x08049000 <_start+0>:       ba 0e 00 00 00          mov    edx,0xe
   0x08049005 <_start+5>:       b9 00 a0 04 08          mov    ecx,0x804a000
   0x0804900a <_start+10>:      bb 01 00 00 00          mov    ebx,0x1
   0x0804900f <_start+15>:      b8 04 00 00 00          mov    eax,0x4
   0x08049014 <_start+20>:      cd 80                   int    0x80
   0x08049016 <_start+22>:      b8 01 00 00 00          mov    eax,0x1
   0x0804901b <_start+27>:      cd 80                   int    0x80
End of assembler dump.
gef➤  memory watch 0x8049000 4160 byte
[+] Adding memwatch to 0x8049000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x8049000 ────
0x08049000 <_start+0000>    ba 0e 00 00 00 b9 00 a0 04 08 bb 01 00 00 00 b8    ................
0x08049010 <_start+0010>    04 00 00 00 cd 80 b8 01 00 00 00 cd 80 00 00 00    ................
0x08049020     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049030     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049050     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049080     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049090     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080490f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049100     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049110     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049120     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049130     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049140     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049150     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049160     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049170     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049180     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049190     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080491f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049200     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049210     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049220     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049230     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049240     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049250     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049260     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049270     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049280     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049290     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080492f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049300     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049310     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049320     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049330     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049340     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049350     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049360     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049370     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049380     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049390     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080493f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049400     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049410     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049420     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049430     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049440     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049450     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049460     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049470     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049480     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049490     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080494f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049500     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049510     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049520     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049530     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049540     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049550     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049560     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049570     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049580     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049590     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080495f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049600     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049610     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049620     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049630     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049640     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049650     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049660     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049670     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049680     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049690     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080496f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049700     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049710     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049720     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049730     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049740     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049750     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049760     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049770     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049780     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049790     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080497f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049800     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049810     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049820     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049830     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049840     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049850     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049860     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049870     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049880     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049890     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080498f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049900     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049910     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049920     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049930     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049940     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049950     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049960     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049970     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049980     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049990     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499a0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499b0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499c0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499d0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499e0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x080499f0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049a90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049aa0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ab0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ac0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ad0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ae0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049af0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049b90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ba0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049bb0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049bc0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049bd0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049be0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049bf0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049c90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ca0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049cb0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049cc0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049cd0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ce0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049cf0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049d90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049da0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049db0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049dc0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049dd0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049de0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049df0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049e90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ea0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049eb0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ec0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ed0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ee0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ef0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f00     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f10     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f20     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f30     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f40     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f50     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f60     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f70     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f80     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049f90     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049fa0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049fb0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049fc0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049fd0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049fe0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x08049ff0     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a000 <msg+0000>    48 65 6c 6c 6f 2c 20 77 6f 72 6c 64 21 0a 00 00    Hello, world!...
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a020     01 00 00 00 00 00 00 00 00 00 00 00 04 00 f1 ff    ................
0x0804a030     0b 00 00 00 00 a0 04 08 00 00 00 00 00 00 02 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  x/s 0x0804a000
0x804a000:      "Hello, world!\n"
gef➤  x/4xw 0x0804a000
0x804a000:      0x6c6c6548      0x77202c6f      0x646c726f      0x00000a21
gef➤
```

## 9starts.asm

```
choice   DB    'Y'      ;ASCII of y = 79H
number1  DW    12345    ;12345D = 3039H
number2  DD    12345679 ;123456789D = 75BCD15H
marks    TIMES 9  DW 0
```

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start	 ;must be declared for linker (gcc)
	
_start:	         ;tell linker entry point
   mov	edx,len  ;message length
   mov	ecx,msg  ;message to write
   mov	ebx,1    ;file descriptor (stdout)
   mov	eax,4    ;system call number (sys_write)
   int	0x80     ;call kernel
	
   mov	edx,9    ;message length
   mov	ecx,s2   ;message to write
   mov	ebx,1    ;file descriptor (stdout)
   mov	eax,4    ;system call number (sys_write)
   int	0x80     ;call kernel
	
   mov	eax,1    ;system call number (sys_exit)
   int	0x80     ;call kernel
	
section	.data
msg db 'Displaying 9 stars',0xa ;a message
len equ $ - msg  ;length of message
s2 times 9 db '*'
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 9starts.asm
ld -m elf_i386 -o 9starts 9starts.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q 9starts
Reading symbols from 9starts...
(No debugging symbols found in 9starts)
Error while writing index for `/root/box/9starts': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
...
gef➤  memory watch 0x8049000 64 byte
[+] Adding memwatch to 0x8049000
gef➤  memory watch 0x804a000 64 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x8049000 ────
0x08049000 <_start+0000>    ba 13 00 00 00 b9 00 a0 04 08 bb 01 00 00 00 b8    ................
0x08049010 <_start+0010>    04 00 00 00 cd 80 ba 09 00 00 00 b9 13 a0 04 08    ................
0x08049020 <_start+0020>    bb 01 00 00 00 b8 04 00 00 00 cd 80 b8 01 00 00    ................
0x08049030 <_start+0030>    00 cd 80 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg+0000>    44 69 73 70 6c 61 79 69 6e 67 20 39 20 73 74 61    Displaying 9 sta
0x0804a010 <msg+0010>    72 73 0a 2a 2a 2a 2a 2a 2a 2a 2a 2a 00 00 00 00    rs.*********....
0x0804a020     00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00    ................
0x0804a030     00 00 00 00 00 00 00 00 04 00 f1 ff 0d 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤
```

## input.asm

{% capture code %}
{% highlight nasm linenos %}
section .data                           ;Data segment
   userMsg db 'Please enter a number: ' ;Ask the user to enter a number
   lenUserMsg equ $-userMsg             ;The length of the message
   dispMsg db 'You have entered: '
   lenDispMsg equ $-dispMsg                 

section .bss           ;Uninitialized data
   num resb 5
	
section .text          ;Code Segment
   global _start
	
_start:                ;User prompt
   ;Output the message 'Please enter a number: '
   mov eax, 4
   mov ebx, 1
   mov ecx, userMsg
   mov edx, lenUserMsg
   int 80h

   ;Read and store the user input
   mov eax, 3
   mov ebx, 2
   mov ecx, num  
   mov edx, 5          ;5 bytes (numeric, 1 for sign) of that information
   int 80h
	
   ;Output the message 'The entered number is: '
   mov eax, 4
   mov ebx, 1
   mov ecx, dispMsg
   mov edx, lenDispMsg
   int 80h  

   ;Output the number entered
   mov eax, 4
   mov ebx, 1
   mov ecx, num
   mov edx, 5
   int 80h  
    
   ; Exit code
   mov eax, 1
   mov ebx, 0
   int 80h
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 input.asm
ld -m elf_i386 -o input input.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q input
Reading symbols from input...
(No debugging symbols found in input)
Error while writing index for `/root/box/input': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
...
gef➤  disassemble _start,+100
Dump of assembler code from 0x8049000 to 0x8049064:
=> 0x08049000 <_start+0>:       mov    eax,0x4
   0x08049005 <_start+5>:       mov    ebx,0x1
   0x0804900a <_start+10>:      mov    ecx,0x804a000
   0x0804900f <_start+15>:      mov    edx,0x17
   0x08049014 <_start+20>:      int    0x80
   0x08049016 <_start+22>:      mov    eax,0x3
   0x0804901b <_start+27>:      mov    ebx,0x2
   0x08049020 <_start+32>:      mov    ecx,0x804a02c
   0x08049025 <_start+37>:      mov    edx,0x5
   0x0804902a <_start+42>:      int    0x80
   0x0804902c <_start+44>:      mov    eax,0x4
   0x08049031 <_start+49>:      mov    ebx,0x1
   0x08049036 <_start+54>:      mov    ecx,0x804a017
   0x0804903b <_start+59>:      mov    edx,0x12
   0x08049040 <_start+64>:      int    0x80
   0x08049042 <_start+66>:      mov    eax,0x4
   0x08049047 <_start+71>:      mov    ebx,0x1
   0x0804904c <_start+76>:      mov    ecx,0x804a02c
   0x08049051 <_start+81>:      mov    edx,0x5
   0x08049056 <_start+86>:      int    0x80
   0x08049058 <_start+88>:      mov    eax,0x1
   0x0804905d <_start+93>:      mov    ebx,0x0
   0x08049062 <_start+98>:      int    0x80
End of assembler dump.
gef➤  b *_start+44
Breakpoint 1 at 0x804902c
gef➤  memory watch 0x804a000 64 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <userMsg+0000>    50 6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 6e    Please enter a n
0x0804a010 <userMsg+0010>    75 6d 62 65 72 3a 20 59 6f 75 20 68 61 76 65 20    umber: You have
0x0804a020 <dispMsg+0009>    65 6e 74 65 72 65 64 3a 20 00 00 00 00 00 00 00    entered: .......
0x0804a030 <num+0004>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.
Please enter a number: 1234

Breakpoint 1, 0x0804902c in _start ()
...
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <userMsg+0000>    50 6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 6e    Please enter a n
0x0804a010 <userMsg+0010>    75 6d 62 65 72 3a 20 59 6f 75 20 68 61 76 65 20    umber: You have
0x0804a020 <dispMsg+0009>    65 6e 74 65 72 65 64 3a 20 00 00 00 31 32 33 34    entered: ...1234
0x0804a030 <num+0004>    0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤
```

## mov.asm

```
MOV  register, register
MOV  register, immediate
MOV  memory, immediate
MOV  register, memory
MOV  memory, register
```

{% capture code %}
{% highlight nasm linenos %}
section .data                           ;Data segment
section	.text
   global _start     ;must be declared for linker (ld)
_start:             ;tell linker entry point
	
   ;writing the name 'Zara Ali'
   mov	edx,9       ;message length
   mov	ecx,name    ;message to write
   mov	ebx,1       ;file descriptor (stdout)
   mov	eax,4       ;system call number (sys_write)
   int	0x80        ;call kernel
	
   mov	[name],  dword 'Nuha'    ; Changed the name to Nuha Ali
	
   ;writing the name 'Nuha Ali'
   mov	edx,9       ;message length
   mov	ecx,name    ;message to write
   mov	ebx,1       ;file descriptor (stdout)
   mov	eax,4       ;system call number (sys_write)
   int	0x80        ;call kernel
	
   mov	eax,1       ;system call number (sys_exit)
   int	0x80        ;call kernel

section	.data
name db 'Zara Ali',0xa
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 mov.asm
ld -m elf_i386 -o mov mov.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q mov
Reading symbols from mov...
(No debugging symbols found in mov)
Error while writing index for `/root/box/mov': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
...
gef➤  disassemble _start,+60
Dump of assembler code from 0x8049000 to 0x804903c:
=> 0x08049000 <_start+0>:       mov    edx,0x9
   0x08049005 <_start+5>:       mov    ecx,0x804a000
   0x0804900a <_start+10>:      mov    ebx,0x1
   0x0804900f <_start+15>:      mov    eax,0x4
   0x08049014 <_start+20>:      int    0x80
   0x08049016 <_start+22>:      mov    DWORD PTR ds:0x804a000,0x6168754e
   0x08049020 <_start+32>:      mov    edx,0x9
   0x08049025 <_start+37>:      mov    ecx,0x804a000
   0x0804902a <_start+42>:      mov    ebx,0x1
   0x0804902f <_start+47>:      mov    eax,0x4
   0x08049034 <_start+52>:      int    0x80
   0x08049036 <_start+54>:      mov    eax,0x1
   0x0804903b <_start+59>:      int    0x80
End of assembler dump.
gef➤  b *_start+32
Breakpoint 1 at 0x8049020
gef➤  memory watch 0x804a000 64 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <name+0000>    5a 61 72 61 20 41 6c 69 0a 00 00 00 00 00 00 00    Zara Ali........
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00    ................
0x0804a020     00 00 00 00 00 00 00 00 04 00 f1 ff 09 00 00 00    ................
0x0804a030     00 a0 04 08 00 00 00 00 00 00 02 00 13 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.
Zara Ali

Breakpoint 1, 0x08049020 in _start ()
...
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <name+0000>    4e 75 68 61 20 41 6c 69 0a 00 00 00 00 00 00 00    Nuha Ali........
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00    ................
0x0804a020     00 00 00 00 00 00 00 00 04 00 f1 ff 09 00 00 00    ................
0x0804a030     00 a0 04 08 00 00 00 00 00 00 02 00 13 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤
```

## sum.asm

{% capture code %}
{% highlight nasm linenos %}
SYS_EXIT  equ 1
SYS_READ  equ 3
SYS_WRITE equ 4
STDIN     equ 0
STDOUT    equ 1

segment .data 

   msg1 db "Enter a digit: "
   len1 equ $- msg1 

   msg2 db "Please enter a second digit: "
   len2 equ $- msg2 

   msg3 db "The sum is: "
   len3 equ $- msg3

segment .bss

   num1 resb 2 
   num2 resb 2 
   res resb 1    

section	.text
   global _start    ;must be declared for using gcc
	
_start:             ;tell linker entry point
   mov eax, SYS_WRITE         
   mov ebx, STDOUT         
   mov ecx, msg1         
   mov edx, len1 
   int 0x80                

   mov eax, SYS_READ 
   mov ebx, STDIN  
   mov ecx, num1 
   mov edx, 2
   int 0x80            

   mov eax, SYS_WRITE        
   mov ebx, STDOUT         
   mov ecx, msg2          
   mov edx, len2         
   int 0x80

   mov eax, SYS_READ  
   mov ebx, STDIN  
   mov ecx, num2 
   mov edx, 2
   int 0x80        

   mov eax, SYS_WRITE         
   mov ebx, STDOUT         
   mov ecx, msg3          
   mov edx, len3         
   int 0x80

   ; moving the first number to eax register and second number to ebx
   ; and subtracting ascii '0' to convert it into a decimal number
	
   mov eax, [num1]
   sub eax, '0'
	
   mov ebx, [num2]
   sub ebx, '0'

   ; add eax and ebx
   add eax, ebx
   ; add '0' to to convert the sum from decimal to ASCII
   add eax, '0'

   ; storing the sum in memory location res
   mov [res], eax

   ; print the sum 
   mov eax, SYS_WRITE        
   mov ebx, STDOUT
   mov ecx, res         
   mov edx, 1        
   int 0x80

exit:    
   
   mov eax, SYS_EXIT   
   xor ebx, ebx 
   int 0x80
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 sum.asm
ld -m elf_i386 -o sum sum.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q sum
Reading symbols from sum...
(No debugging symbols found in sum)
Error while writing index for `/root/box/sum': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.00ms using Python engine 3.11
gef➤  start
...
gef➤  disassemble _start,+168
Dump of assembler code from 0x8049000 to 0x80490a8:
=> 0x08049000 <_start+0>:       mov    eax,0x4
   0x08049005 <_start+5>:       mov    ebx,0x1
   0x0804900a <_start+10>:      mov    ecx,0x804a000
   0x0804900f <_start+15>:      mov    edx,0xf
   0x08049014 <_start+20>:      int    0x80
   0x08049016 <_start+22>:      mov    eax,0x3
   0x0804901b <_start+27>:      mov    ebx,0x0
   0x08049020 <_start+32>:      mov    ecx,0x804a038
   0x08049025 <_start+37>:      mov    edx,0x2
   0x0804902a <_start+42>:      int    0x80
   0x0804902c <_start+44>:      mov    eax,0x4
   0x08049031 <_start+49>:      mov    ebx,0x1
   0x08049036 <_start+54>:      mov    ecx,0x804a00f
   0x0804903b <_start+59>:      mov    edx,0x1d
   0x08049040 <_start+64>:      int    0x80
   0x08049042 <_start+66>:      mov    eax,0x3
   0x08049047 <_start+71>:      mov    ebx,0x0
   0x0804904c <_start+76>:      mov    ecx,0x804a03a
   0x08049051 <_start+81>:      mov    edx,0x2
   0x08049056 <_start+86>:      int    0x80
   0x08049058 <_start+88>:      mov    eax,0x4
   0x0804905d <_start+93>:      mov    ebx,0x1
   0x08049062 <_start+98>:      mov    ecx,0x804a02c
   0x08049067 <_start+103>:     mov    edx,0xc
   0x0804906c <_start+108>:     int    0x80
   0x0804906e <_start+110>:     mov    eax,ds:0x804a038
   0x08049073 <_start+115>:     sub    eax,0x30
   0x08049076 <_start+118>:     mov    ebx,DWORD PTR ds:0x804a03a
   0x0804907c <_start+124>:     sub    ebx,0x30
   0x0804907f <_start+127>:     add    eax,ebx
   0x08049081 <_start+129>:     add    eax,0x30
   0x08049084 <_start+132>:     mov    ds:0x804a03c,eax
   0x08049089 <_start+137>:     mov    eax,0x4
   0x0804908e <_start+142>:     mov    ebx,0x1
   0x08049093 <_start+147>:     mov    ecx,0x804a03c
   0x08049098 <_start+152>:     mov    edx,0x1
   0x0804909d <_start+157>:     int    0x80
   0x0804909f <exit+0>: mov    eax,0x1
   0x080490a4 <exit+5>: xor    ebx,ebx
   0x080490a6 <exit+7>: int    0x80
End of assembler dump.
gef➤  b *_start+44
Breakpoint 1 at 0x804902c
gef➤  b *_start+88
Breakpoint 2 at 0x8049058
gef➤  b *_start+110
Breakpoint 3 at 0x804906e
gef➤  memory watch 0x804a000 80 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 00 00 00 00 00 00 00 00    sum is: ........
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.
Enter a digit: 2

Breakpoint 1, 0x0804902c in _start ()
...
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 00 00 00 00 00 00    sum is: 2.......
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
...
gef➤  continue
Continuing.
Please enter a second digit: 3

Breakpoint 2, 0x08049058 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
...
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
...
gef➤  continue
Continuing.
The sum is:
Breakpoint 3, 0x0804906e in _start ()
...
gef➤  stepi
0x08049073 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa330a32  ("2\n3\n"?)
$ebx   : 0x1
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049067 ba0c000000          <_start+103>     mov    edx, 0xc
    0x804906c cd80                <_start+108>     int    0x80
    0x804906e a138a00408          <_start+110>     mov    eax, ds:0x804a038
 →  0x8049073 83e830              <_start+115>     sub    eax, 0x30
    0x8049076 8b1d3aa00408        <_start+118>     mov    ebx, DWORD PTR ds:0x804a03a
    0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
    0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049076 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa330a02
$ebx   : 0x1
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804906c cd80                <_start+108>     int    0x80
    0x804906e a138a00408          <_start+110>     mov    eax, ds:0x804a038
    0x8049073 83e830              <_start+115>     sub    eax, 0x30
 →  0x8049076 8b1d3aa00408        <_start+118>     mov    ebx, DWORD PTR ds:0x804a03a
    0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
    0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
    0x8049089 b804000000          <_start+137>     mov    eax, 0x4
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
...
gef➤  stepi
0x0804907c in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa330a02
$ebx   : 0xa33
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804906e a138a00408          <_start+110>     mov    eax, ds:0x804a038
    0x8049073 83e830              <_start+115>     sub    eax, 0x30
    0x8049076 8b1d3aa00408        <_start+118>     mov    ebx, DWORD PTR ds:0x804a03a
 →  0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
    0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
    0x8049089 b804000000          <_start+137>     mov    eax, 0x4
    0x804908e bb01000000          <_start+142>     mov    ebx, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804907f in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa330a02
$ebx   : 0xa03
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049073 83e830              <_start+115>     sub    eax, 0x30
    0x8049076 8b1d3aa00408        <_start+118>     mov    ebx, DWORD PTR ds:0x804a03a
    0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
 →  0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
    0x8049089 b804000000          <_start+137>     mov    eax, 0x4
    0x804908e bb01000000          <_start+142>     mov    ebx, 0x1
    0x8049093 b93ca00408          <_start+147>     mov    ecx, 0x804a03c
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049081 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa331405
$ebx   : 0xa03
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049076 8b1d3aa00408        <_start+118>     mov    ebx, DWORD PTR ds:0x804a03a
    0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
    0x804907f 01d8                <_start+127>     add    eax, ebx
 →  0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
    0x8049089 b804000000          <_start+137>     mov    eax, 0x4
    0x804908e bb01000000          <_start+142>     mov    ebx, 0x1
    0x8049093 b93ca00408          <_start+147>     mov    ecx, 0x804a03c
    0x8049098 ba01000000          <_start+152>     mov    edx, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049084 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa331435
$ebx   : 0xa03
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804907c 83eb30              <_start+124>     sub    ebx, 0x30
    0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
 →  0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
    0x8049089 b804000000          <_start+137>     mov    eax, 0x4
    0x804908e bb01000000          <_start+142>     mov    ebx, 0x1
    0x8049093 b93ca00408          <_start+147>     mov    ecx, 0x804a03c
    0x8049098 ba01000000          <_start+152>     mov    edx, 0x1
    0x804909d cd80                <_start+157>     int    0x80
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 00 00 00 00    sum is: 2.3.....
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049089 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xa331435
$ebx   : 0xa03
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804907f 01d8                <_start+127>     add    eax, ebx
    0x8049081 83c030              <_start+129>     add    eax, 0x30
    0x8049084 a33ca00408          <_start+132>     mov    ds:0x804a03c, eax
 →  0x8049089 b804000000          <_start+137>     mov    eax, 0x4
    0x804908e bb01000000          <_start+142>     mov    ebx, 0x1
    0x8049093 b93ca00408          <_start+147>     mov    ecx, 0x804a03c
    0x8049098 ba01000000          <_start+152>     mov    edx, 0x1
    0x804909d cd80                <_start+157>     int    0x80
    0x804909f b801000000          <exit+0>         mov    eax, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <msg1+0000>    45 6e 74 65 72 20 61 20 64 69 67 69 74 3a 20 50    Enter a digit: P
0x0804a010 <msg2+0001>    6c 65 61 73 65 20 65 6e 74 65 72 20 61 20 73 65    lease enter a se
0x0804a020 <msg2+0011>    63 6f 6e 64 20 64 69 67 69 74 3a 20 54 68 65 20    cond digit: The
0x0804a030 <msg3+0004>    73 75 6d 20 69 73 3a 20 32 0a 33 0a 35 14 33 0a    sum is: 2.3.5.3.
0x0804a040     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.
5[Inferior 1 (process 1732025) exited normally]
gef➤
```

## mul.asm

`al x 8 bit source = ah al`<br>
`ax x 16 bit source = dx ax`<br>
`eax x 32 bit source = edx eax`

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start    ;must be declared for using gcc
	
_start:             ;tell linker entry point

   mov	al, '3'
   sub	al, '0'
	
   mov 	bl, '2'
   sub	bl, '0'
   mul 	bl
   add	al, '0'
	
   mov 	[res], al
   mov	ecx, msg	
   mov	edx, len
   mov	ebx, 1	;file descriptor (stdout)
   mov	eax, 4	;system call number (sys_write)
   int	0x80	;call kernel
	
   mov	ecx, res
   mov	edx, 1
   mov	ebx, 1	;file descriptor (stdout)
   mov	eax, 4	;system call number (sys_write)
   int	0x80	;call kernel
	
   mov	eax, 1	;system call number (sys_exit)
   int	0x80	;call kernel

section .data
msg db "The result is: " 
len equ $- msg   
segment .bss
res resb 1
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 mul.asm
ld -m elf_i386 -o mul mul.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q mul
Reading symbols from mul...
(No debugging symbols found in mul)
Error while writing index for `/root/box/mul': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.00ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 b033                <_start+0>       mov    al, 0x33
    0x8049002 2c30                <_start+2>       sub    al, 0x30
    0x8049004 b332                <_start+4>       mov    bl, 0x32
    0x8049006 80eb30              <_start+6>       sub    bl, 0x30
    0x8049009 f6e3                <_start+9>       mul    bl
    0x804900b 0430                <_start+11>      add    al, 0x30
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049002 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x33
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 b033                <_start+0>       mov    al, 0x33
 →  0x8049002 2c30                <_start+2>       sub    al, 0x30
    0x8049004 b332                <_start+4>       mov    bl, 0x32
    0x8049006 80eb30              <_start+6>       sub    bl, 0x30
    0x8049009 f6e3                <_start+9>       mul    bl
    0x804900b 0430                <_start+11>      add    al, 0x30
    0x804900d a210a00408          <_start+13>      mov    ds:0x804a010, al
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049004 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 b033                <_start+0>       mov    al, 0x33
    0x8049002 2c30                <_start+2>       sub    al, 0x30
 →  0x8049004 b332                <_start+4>       mov    bl, 0x32
    0x8049006 80eb30              <_start+6>       sub    bl, 0x30
    0x8049009 f6e3                <_start+9>       mul    bl
    0x804900b 0430                <_start+11>      add    al, 0x30
    0x804900d a210a00408          <_start+13>      mov    ds:0x804a010, al
    0x8049012 b900a00408          <_start+18>      mov    ecx, 0x804a000
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049006 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3
$ebx   : 0x32
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 b033                <_start+0>       mov    al, 0x33
    0x8049002 2c30                <_start+2>       sub    al, 0x30
    0x8049004 b332                <_start+4>       mov    bl, 0x32
 →  0x8049006 80eb30              <_start+6>       sub    bl, 0x30
    0x8049009 f6e3                <_start+9>       mul    bl
    0x804900b 0430                <_start+11>      add    al, 0x30
    0x804900d a210a00408          <_start+13>      mov    ds:0x804a010, al
    0x8049012 b900a00408          <_start+18>      mov    ecx, 0x804a000
    0x8049017 ba0f000000          <_start+23>      mov    edx, 0xf
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049009 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049002 2c30                <_start+2>       sub    al, 0x30
    0x8049004 b332                <_start+4>       mov    bl, 0x32
    0x8049006 80eb30              <_start+6>       sub    bl, 0x30
 →  0x8049009 f6e3                <_start+9>       mul    bl
    0x804900b 0430                <_start+11>      add    al, 0x30
    0x804900d a210a00408          <_start+13>      mov    ds:0x804a010, al
    0x8049012 b900a00408          <_start+18>      mov    ecx, 0x804a000
    0x8049017 ba0f000000          <_start+23>      mov    edx, 0xf
    0x804901c bb01000000          <_start+28>      mov    ebx, 0x1
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900b in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x6
$ebx   : 0x2
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049004 b332                <_start+4>       mov    bl, 0x32
    0x8049006 80eb30              <_start+6>       sub    bl, 0x30
    0x8049009 f6e3                <_start+9>       mul    bl
 →  0x804900b 0430                <_start+11>      add    al, 0x30
    0x804900d a210a00408          <_start+13>      mov    ds:0x804a010, al
    0x8049012 b900a00408          <_start+18>      mov    ecx, 0x804a000
    0x8049017 ba0f000000          <_start+23>      mov    edx, 0xf
    0x804901c bb01000000          <_start+28>      mov    ebx, 0x1
    0x8049021 b804000000          <_start+33>      mov    eax, 0x4
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤
```

## div.asm

`ax / 8 bit divisor = al (quotient) and ah (remainder)`<br>
`dx ax / 16 bit divisor = ax (quotient) and dx (remainder)`<br>
`edx eax / 32 bit divisor = eax (quotient) and edx (remainder)`

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start    ;must be declared for using gcc
	
_start:             ;tell linker entry point
   mov	ax, '7'
   sub	ax, '0'
	
   mov 	bl, '2'
   sub	bl, '0'
   div 	bl
   add	ax, '0'
	
   mov 	[res], ax
   mov	ecx, msg	
   mov	edx, len
   mov	ebx, 1	;file descriptor (stdout)
   mov	eax, 4	;system call number (sys_write)
   int	0x80	;call kernel
	
   mov	ecx, res
   mov	edx, 1
   mov	ebx, 1	;file descriptor (stdout)
   mov	eax, 4	;system call number (sys_write)
   int	0x80	;call kernel
	
   mov	eax, 1	;system call number (sys_exit)
   int	0x80	;call kernel
	
section .data
msg db "The result is: "
len equ $- msg   
segment .bss
res resb 1
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 div.asm
ld -m elf_i386 -o div div.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q div
Reading symbols from div...
(No debugging symbols found in div)
Error while writing index for `/root/box/div': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 66b83700            <_start+0>       mov    ax, 0x37
    0x8049004 6683e830            <_start+4>       sub    ax, 0x30
    0x8049008 b332                <_start+8>       mov    bl, 0x32
    0x804900a 80eb30              <_start+10>      sub    bl, 0x30
    0x804900d f6f3                <_start+13>      div    bl
    0x804900f 6683c030            <_start+15>      add    ax, 0x30
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049004 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x37
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 66b83700            <_start+0>       mov    ax, 0x37
 →  0x8049004 6683e830            <_start+4>       sub    ax, 0x30
    0x8049008 b332                <_start+8>       mov    bl, 0x32
    0x804900a 80eb30              <_start+10>      sub    bl, 0x30
    0x804900d f6f3                <_start+13>      div    bl
    0x804900f 6683c030            <_start+15>      add    ax, 0x30
    0x8049013 66a310a00408        <_start+19>      mov    ds:0x804a010, ax
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049008 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x7
$ebx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 66b83700            <_start+0>       mov    ax, 0x37
    0x8049004 6683e830            <_start+4>       sub    ax, 0x30
 →  0x8049008 b332                <_start+8>       mov    bl, 0x32
    0x804900a 80eb30              <_start+10>      sub    bl, 0x30
    0x804900d f6f3                <_start+13>      div    bl
    0x804900f 6683c030            <_start+15>      add    ax, 0x30
    0x8049013 66a310a00408        <_start+19>      mov    ds:0x804a010, ax
    0x8049019 b900a00408          <_start+25>      mov    ecx, 0x804a000
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900a in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x7
$ebx   : 0x32
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 66b83700            <_start+0>       mov    ax, 0x37
    0x8049004 6683e830            <_start+4>       sub    ax, 0x30
    0x8049008 b332                <_start+8>       mov    bl, 0x32
 →  0x804900a 80eb30              <_start+10>      sub    bl, 0x30
    0x804900d f6f3                <_start+13>      div    bl
    0x804900f 6683c030            <_start+15>      add    ax, 0x30
    0x8049013 66a310a00408        <_start+19>      mov    ds:0x804a010, ax
    0x8049019 b900a00408          <_start+25>      mov    ecx, 0x804a000
    0x804901e ba0f000000          <_start+30>      mov    edx, 0xf
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900d in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x7
$ebx   : 0x2
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049004 6683e830            <_start+4>       sub    ax, 0x30
    0x8049008 b332                <_start+8>       mov    bl, 0x32
    0x804900a 80eb30              <_start+10>      sub    bl, 0x30
 →  0x804900d f6f3                <_start+13>      div    bl
    0x804900f 6683c030            <_start+15>      add    ax, 0x30
    0x8049013 66a310a00408        <_start+19>      mov    ds:0x804a010, ax
    0x8049019 b900a00408          <_start+25>      mov    ecx, 0x804a000
    0x804901e ba0f000000          <_start+30>      mov    edx, 0xf
    0x8049023 bb01000000          <_start+35>      mov    ebx, 0x1
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900f in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x103
$ebx   : 0x2
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049008 b332                <_start+8>       mov    bl, 0x32
    0x804900a 80eb30              <_start+10>      sub    bl, 0x30
    0x804900d f6f3                <_start+13>      div    bl
 →  0x804900f 6683c030            <_start+15>      add    ax, 0x30
    0x8049013 66a310a00408        <_start+19>      mov    ds:0x804a010, ax
    0x8049019 b900a00408          <_start+25>      mov    ecx, 0x804a000
    0x804901e ba0f000000          <_start+30>      mov    edx, 0xf
    0x8049023 bb01000000          <_start+35>      mov    ebx, 0x1
    0x8049028 b804000000          <_start+40>      mov    eax, 0x4
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤
```

## and.asm

{% capture code %}
{% highlight nasm linenos %}
section .text
   global _start            ;must be declared for using gcc
	
_start:                     ;tell linker entry point
   mov   ax, 8h             ;getting 8 in the ax 
   and   ax, 1              ;and ax with 1
   jz    evnn
   mov   eax, 4             ;system call number (sys_write)
   mov   ebx, 1             ;file descriptor (stdout)
   mov   ecx, odd_msg       ;message to write
   mov   edx, len2          ;length of message
   int   0x80               ;call kernel
   jmp   outprog

evnn:   

   mov   eax, 4             ;system call number (sys_write)
   mov   ebx, 1             ;file descriptor (stdout)
   mov   ecx, even_msg      ;message to write
   mov   edx, len1          ;length of message
   int   0x80               ;call kernel

outprog:

   mov   eax,1              ;system call number (sys_exit)
   int   0x80               ;call kernel

section   .data
even_msg  db  'Even Number!' ;message showing even number
len1  equ  $ - even_msg 
   
odd_msg db  'Odd Number!'    ;message showing odd number
len2  equ  $ - odd_msg
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 and.asm
ld -m elf_i386 -o and and.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q and
Reading symbols from and...
(No debugging symbols found in and)
Error while writing index for `/root/box/and': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
...
$eip   : 0x08049000  →  <_start+0> mov ax, 0x8
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 66b80800            <_start+0>       mov    ax, 0x8
    0x8049004 6683e001            <_start+4>       and    ax, 0x1
    0x8049008 7418                <_start+8>       je     0x8049022 <evnn>
    0x804900a b804000000          <_start+10>      mov    eax, 0x4
    0x804900f bb01000000          <_start+15>      mov    ebx, 0x1
    0x8049014 b90ca00408          <_start+20>      mov    ecx, 0x804a00c
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049004 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x8
...
$eip   : 0x08049004  →  <_start+4> and ax, 0x1
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffd 0000                                 add    BYTE PTR [eax], al
    0x8048fff 0066b8                               add    BYTE PTR [esi-0x48], ah
    0x8049002 0800                <_start+2>       or     BYTE PTR [eax], al
 →  0x8049004 6683e001            <_start+4>       and    ax, 0x1
    0x8049008 7418                <_start+8>       je     0x8049022 <evnn>
    0x804900a b804000000          <_start+10>      mov    eax, 0x4
    0x804900f bb01000000          <_start+15>      mov    ebx, 0x1
    0x8049014 b90ca00408          <_start+20>      mov    ecx, 0x804a00c
    0x8049019 ba0b000000          <_start+25>      mov    edx, 0xb
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049008 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
...
$eip   : 0x08049008  →  <_start+8> je 0x8049022 <evnn>
$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048fff 0066b8                               add    BYTE PTR [esi-0x48], ah
    0x8049002 0800                <_start+2>       or     BYTE PTR [eax], al
    0x8049004 6683e001            <_start+4>       and    ax, 0x1
 →  0x8049008 7418                <_start+8>       je     0x8049022 <evnn>      TAKEN [Reason: Z]
   ↳   0x8049022 <evnn+0>         mov    eax, 0x4
       0x8049027 <evnn+5>         mov    ebx, 0x1
       0x804902c <evnn+10>        mov    ecx, 0x804a000
       0x8049031 <evnn+15>        mov    edx, 0xc
       0x8049036 <evnn+20>        int    0x80
       0x8049038 <outprog+0>      mov    eax, 0x1
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049022 in evnn ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
...
$eip   : 0x08049022  →  <evnn+0> mov eax, 0x4
$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049019 ba0b000000          <_start+25>      mov    edx, 0xb
    0x804901e cd80                <_start+30>      int    0x80
    0x8049020 eb16                <_start+32>      jmp    0x8049038 <outprog>
 →  0x8049022 b804000000          <evnn+0>         mov    eax, 0x4
    0x8049027 bb01000000          <evnn+5>         mov    ebx, 0x1
    0x804902c b900a00408          <evnn+10>        mov    ecx, 0x804a000
    0x8049031 ba0c000000          <evnn+15>        mov    edx, 0xc
    0x8049036 cd80                <evnn+20>        int    0x80
    0x8049038 b801000000          <outprog+0>      mov    eax, 0x1
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  x/s 0x804a000
0x804a000:      "Even Number!Odd Number!"
gef➤
```

## cmp.asm

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start         ;must be declared for using gcc

_start:	                 ;tell linker entry point
   mov   ecx, [num1]
   cmp   ecx, [num2]	 ;compare ecx value with num2 value (like ecx - [num2] without storing)
   jg    check_third_num ;jg = jump if greater, if num1 > num2 than jmp to cmp num1 and num3, else num2 be largest and cmp with num3
   mov   ecx, [num2]
   
check_third_num:

   cmp   ecx, [num3]
   jg    _exit
   mov   ecx, [num3]
   
_exit:
   
   mov   [largest], ecx
   mov   ecx,msg
   mov   edx, len
   mov   ebx,1	;file descriptor (stdout)
   mov   eax,4	;system call number (sys_write)
   int   0x80	;call kernel
	
   mov   ecx,largest
   mov   edx, 2
   mov   ebx,1	;file descriptor (stdout)
   mov   eax,4	;system call number (sys_write)
   int   0x80	;call kernel
    
   mov   eax, 1
   int   80h

section	.data
   
   msg db "The largest digit is: "
   len equ $- msg 
   num1 dd '47'
   num2 dd '22'
   num3 dd '31'

segment .bss
   largest resb 2  
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 cmp.asm
ld -m elf_i386 -o cmp cmp.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q cmp
Reading symbols from cmp...
(No debugging symbols found in cmp)
Error while writing index for `/root/box/cmp': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.00ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
...
$ecx   : 0x0
...
$eip   : 0x08049000  →  <_start+0> mov ecx, DWORD PTR ds:0x804a016
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 8b0d16a00408        <_start+0>       mov    ecx, DWORD PTR ds:0x804a016
    0x8049006 3b0d1aa00408        <_start+6>       cmp    ecx, DWORD PTR ds:0x804a01a
    0x804900c 7f06                <_start+12>      jg     0x8049014 <check_third_num>
    0x804900e 8b0d1aa00408        <_start+14>      mov    ecx, DWORD PTR ds:0x804a01a
    0x8049014 3b0d1ea00408        <check_third_num+0> cmp    ecx, DWORD PTR ds:0x804a01e
    0x804901a 7f06                <check_third_num+6> jg     0x8049022 <_exit>
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  memory watch 0x804a016 32 byte
[+] Adding memwatch to 0x804a016
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a016 ────
0x0804a016 <num1+0000>    34 37 00 00 32 32 00 00 33 31 00 00 00 00 00 00    47..22..31......
0x0804a026 <largest+0002>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  stepi
0x08049006 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
...
$ecx   : 0x3734
...
$eip   : 0x08049006  →  <_start+6> cmp ecx, DWORD PTR ds:0x804a01a
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 8b0d16a00408        <_start+0>       mov    ecx, DWORD PTR ds:0x804a016
 →  0x8049006 3b0d1aa00408        <_start+6>       cmp    ecx, DWORD PTR ds:0x804a01a
    0x804900c 7f06                <_start+12>      jg     0x8049014 <check_third_num>
    0x804900e 8b0d1aa00408        <_start+14>      mov    ecx, DWORD PTR ds:0x804a01a
    0x8049014 3b0d1ea00408        <check_third_num+0> cmp    ecx, DWORD PTR ds:0x804a01e
    0x804901a 7f06                <check_third_num+6> jg     0x8049022 <_exit>
    0x804901c 8b0d1ea00408        <check_third_num+8> mov    ecx, DWORD PTR ds:0x804a01e
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a016 ────
0x0804a016 <num1+0000>    34 37 00 00 32 32 00 00 33 31 00 00 00 00 00 00    47..22..31......
0x0804a026 <largest+0002>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900c in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
...
$ecx   : 0x3734
...
$eip   : 0x0804900c  →  <_start+12> jg 0x8049014 <check_third_num>
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048fff 008b0d16a004                         add    BYTE PTR [ebx+0x4a0160d], cl
    0x8049005 083b                <_start+5>       or     BYTE PTR [ebx], bh
    0x8049007 0d1aa00408          <_start+7>       or     eax, 0x804a01a
 →  0x804900c 7f06                <_start+12>      jg     0x8049014 <check_third_num>   TAKEN [Reason: !Z && S==O]
   ↳   0x8049014 <check_third_num+0> cmp    ecx, DWORD PTR ds:0x804a01e
       0x804901a <check_third_num+6> jg     0x8049022 <_exit>
       0x804901c <check_third_num+8> mov    ecx, DWORD PTR ds:0x804a01e
       0x8049022 <_exit+0>        mov    DWORD PTR ds:0x804a024, ecx
       0x8049028 <_exit+6>        mov    ecx, 0x804a000
       0x804902d <_exit+11>       mov    edx, 0x16
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a016 ────
0x0804a016 <num1+0000>    34 37 00 00 32 32 00 00 33 31 00 00 00 00 00 00    47..22..31......
0x0804a026 <largest+0002>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x08049014 in check_third_num ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
...
$ecx   : 0x3734
...
$eip   : 0x08049014  →  <check_third_num+0> cmp ecx, DWORD PTR ds:0x804a01e
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049007 0d1aa00408          <_start+7>       or     eax, 0x804a01a
    0x804900c 7f06                <_start+12>      jg     0x8049014 <check_third_num>
    0x804900e 8b0d1aa00408        <_start+14>      mov    ecx, DWORD PTR ds:0x804a01a
 →  0x8049014 3b0d1ea00408        <check_third_num+0> cmp    ecx, DWORD PTR ds:0x804a01e
    0x804901a 7f06                <check_third_num+6> jg     0x8049022 <_exit>
    0x804901c 8b0d1ea00408        <check_third_num+8> mov    ecx, DWORD PTR ds:0x804a01e
    0x8049022 890d24a00408        <_exit+0>        mov    DWORD PTR ds:0x804a024, ecx
    0x8049028 b900a00408          <_exit+6>        mov    ecx, 0x804a000
    0x804902d ba16000000          <_exit+11>       mov    edx, 0x16
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a016 ────
0x0804a016 <num1+0000>    34 37 00 00 32 32 00 00 33 31 00 00 00 00 00 00    47..22..31......
0x0804a026 <largest+0002>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804901a in check_third_num ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
...
$ecx   : 0x3734
...
$eip   : 0x0804901a  →  <check_third_num+6> jg 0x8049022 <_exit>
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804900c 7f06                <_start+12>      jg     0x8049014 <check_third_num>
    0x804900e 8b0d1aa00408        <_start+14>      mov    ecx, DWORD PTR ds:0x804a01a
    0x8049014 3b0d1ea00408        <check_third_num+0> cmp    ecx, DWORD PTR ds:0x804a01e
 →  0x804901a 7f06                <check_third_num+6> jg     0x8049022 <_exit>  TAKEN [Reason: !Z && S==O]
   ↳   0x8049022 <_exit+0>        mov    DWORD PTR ds:0x804a024, ecx
       0x8049028 <_exit+6>        mov    ecx, 0x804a000
       0x804902d <_exit+11>       mov    edx, 0x16
       0x8049032 <_exit+16>       mov    ebx, 0x1
       0x8049037 <_exit+21>       mov    eax, 0x4
       0x804903c <_exit+26>       int    0x80
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a016 ────
0x0804a016 <num1+0000>    34 37 00 00 32 32 00 00 33 31 00 00 00 00 00 00    47..22..31......
0x0804a026 <largest+0002>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤
```

## loop.asm

```
mov   cl, 10
l1:
<loop body>
dec   cl
jnz   l1
```

```
mov   ecx, 10
l1:
<loop body>
loop  l1       ;loop l1 ~ dec cl and jnz l1
```

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start        ;must be declared for using gcc
	
_start:	                ;tell linker entry point
   mov ecx, 10
   mov eax, '0'
	
l1:
   mov [num], eax
   mov eax, 4
   mov ebx, 1
   push ecx
	
   mov ecx, num        
   mov edx, 1        
   int 0x80
	
   mov eax, [num]
   sub eax, '0'
   inc eax
   add eax, '0'
   pop ecx
   loop l1               ;loop l1 ~ dec cl and jnz l1
	
   mov eax,1             ;system call number (sys_exit)
   int 0x80              ;call kernel
section	.bss
num resb 1
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 loop.asm
ld -m elf_i386 -o loop loop.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q loop
Reading symbols from loop...
(No debugging symbols found in loop)
Error while writing index for `/root/box/loop': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
$ecx   : 0x0
$edx   : 0x0
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049000  →  <_start+0> mov ecx, 0xa
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 b90a000000          <_start+0>       mov    ecx, 0xa
    0x8049005 b830000000          <_start+5>       mov    eax, 0x30
    0x804900a a300a00408          <l1+0>           mov    ds:0x804a000, eax
    0x804900f b804000000          <l1+5>           mov    eax, 0x4
    0x8049014 bb01000000          <l1+10>          mov    ebx, 0x1
    0x8049019 51                  <l1+15>          push   ecx
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049000 in _start (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049000 → _start()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  disassemble /r _start,+60
Dump of assembler code from 0x8049000 to 0x804903c:
=> 0x08049000 <_start+0>:       b9 0a 00 00 00          mov    ecx,0xa
   0x08049005 <_start+5>:       b8 30 00 00 00          mov    eax,0x30
   0x0804900a <l1+0>:   a3 00 a0 04 08          mov    ds:0x804a000,eax
   0x0804900f <l1+5>:   b8 04 00 00 00          mov    eax,0x4
   0x08049014 <l1+10>:  bb 01 00 00 00          mov    ebx,0x1
   0x08049019 <l1+15>:  51                      push   ecx
   0x0804901a <l1+16>:  b9 00 a0 04 08          mov    ecx,0x804a000
   0x0804901f <l1+21>:  ba 01 00 00 00          mov    edx,0x1
   0x08049024 <l1+26>:  cd 80                   int    0x80
   0x08049026 <l1+28>:  a1 00 a0 04 08          mov    eax,ds:0x804a000
   0x0804902b <l1+33>:  83 e8 30                sub    eax,0x30
   0x0804902e <l1+36>:  40                      inc    eax
   0x0804902f <l1+37>:  83 c0 30                add    eax,0x30
   0x08049032 <l1+40>:  59                      pop    ecx
   0x08049033 <l1+41>:  e2 d5                   loop   0x804900a <l1>
   0x08049035 <l1+43>:  b8 01 00 00 00          mov    eax,0x1
   0x0804903a <l1+48>:  cd 80                   int    0x80
End of assembler dump.
gef➤  b *l1+26
Breakpoint 1 at 0x8049024
gef➤  b *l1+41
Breakpoint 2 at 0x8049033
gef➤  memory watch 0x804a000 32 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.

Breakpoint 1, 0x08049024 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x4
$ebx   : 0x1
$ecx   : 0x0804a000  →  0x00000030 ("0"?)
$edx   : 0x1
$esp   : 0xffffd42c  →  0x0000000a ("\n"?)
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049024  →  <l1+26> int 0x80
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd42c│+0x0000: 0x0000000a ("\n"?)   ← $esp
0xffffd430│+0x0004: 0x00000001
0xffffd434│+0x0008: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x000c: 0x00000000
0xffffd43c│+0x0010: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0014: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0018: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x001c: 0xffffd5f9  →  "LANGUAGE=en_US:en"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049019 51                  <l1+15>          push   ecx
    0x804901a b900a00408          <l1+16>          mov    ecx, 0x804a000
    0x804901f ba01000000          <l1+21>          mov    edx, 0x1
 →  0x8049024 cd80                <l1+26>          int    0x80
    0x8049026 a100a00408          <l1+28>          mov    eax, ds:0x804a000
    0x804902b 83e830              <l1+33>          sub    eax, 0x30
    0x804902e 40                  <l1+36>          inc    eax
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    0...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049024 in l1 (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049024 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.
0
Breakpoint 2, 0x08049033 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x31
$ebx   : 0x1
$ecx   : 0xa
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049033  →  <l1+41> loop 0x804900a <l1>
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804902e 40                  <l1+36>          inc    eax
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
 →  0x8049033 e2d5                <l1+41>          loop   0x804900a <l1>
    0x8049035 b801000000          <l1+43>          mov    eax, 0x1
    0x804903a cd80                <l1+48>          int    0x80
    0x804903c 0000                                 add    BYTE PTR [eax], al
    0x804903e 0000                                 add    BYTE PTR [eax], al
    0x8049040 0000                                 add    BYTE PTR [eax], al
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    0...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049033 in l1 (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049033 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  stepi
0x0804900a in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x31
$ebx   : 0x1
$ecx   : 0x9
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x0804900a  →  <l1+0> mov ds:0x804a000, eax
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffd 0000                                 add    BYTE PTR [eax], al
    0x8048fff 00b90a000000                         add    BYTE PTR [ecx+0xa], bh
    0x8049005 b830000000          <_start+5>       mov    eax, 0x30
 →  0x804900a a300a00408          <l1+0>           mov    ds:0x804a000, eax
    0x804900f b804000000          <l1+5>           mov    eax, 0x4
    0x8049014 bb01000000          <l1+10>          mov    ebx, 0x1
    0x8049019 51                  <l1+15>          push   ecx
    0x804901a b900a00408          <l1+16>          mov    ecx, 0x804a000
    0x804901f ba01000000          <l1+21>          mov    edx, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    0...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x804900a in l1 (), reason: SINGLE STEP
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x804900a → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.

Breakpoint 1, 0x08049024 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x4
$ebx   : 0x1
$ecx   : 0x0804a000  →  0x00000031 ("1"?)
$edx   : 0x1
$esp   : 0xffffd42c  →  0x00000009 ("\t"?)
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049024  →  <l1+26> int 0x80
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd42c│+0x0000: 0x00000009 ("\t"?)   ← $esp
0xffffd430│+0x0004: 0x00000001
0xffffd434│+0x0008: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x000c: 0x00000000
0xffffd43c│+0x0010: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0014: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0018: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x001c: 0xffffd5f9  →  "LANGUAGE=en_US:en"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049019 51                  <l1+15>          push   ecx
    0x804901a b900a00408          <l1+16>          mov    ecx, 0x804a000
    0x804901f ba01000000          <l1+21>          mov    edx, 0x1
 →  0x8049024 cd80                <l1+26>          int    0x80
    0x8049026 a100a00408          <l1+28>          mov    eax, ds:0x804a000
    0x804902b 83e830              <l1+33>          sub    eax, 0x30
    0x804902e 40                  <l1+36>          inc    eax
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    1...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049024 in l1 (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049024 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.
1
Breakpoint 2, 0x08049033 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x32
$ebx   : 0x1
$ecx   : 0x9
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049033  →  <l1+41> loop 0x804900a <l1>
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804902e 40                  <l1+36>          inc    eax
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
 →  0x8049033 e2d5                <l1+41>          loop   0x804900a <l1>
    0x8049035 b801000000          <l1+43>          mov    eax, 0x1
    0x804903a cd80                <l1+48>          int    0x80
    0x804903c 0000                                 add    BYTE PTR [eax], al
    0x804903e 0000                                 add    BYTE PTR [eax], al
    0x8049040 0000                                 add    BYTE PTR [eax], al
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    1...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049033 in l1 (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049033 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  stepi
0x0804900a in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x32
$ebx   : 0x1
$ecx   : 0x8
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x0804900a  →  <l1+0> mov ds:0x804a000, eax
$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffd 0000                                 add    BYTE PTR [eax], al
    0x8048fff 00b90a000000                         add    BYTE PTR [ecx+0xa], bh
    0x8049005 b830000000          <_start+5>       mov    eax, 0x30
 →  0x804900a a300a00408          <l1+0>           mov    ds:0x804a000, eax
    0x804900f b804000000          <l1+5>           mov    eax, 0x4
    0x8049014 bb01000000          <l1+10>          mov    ebx, 0x1
    0x8049019 51                  <l1+15>          push   ecx
    0x804901a b900a00408          <l1+16>          mov    ecx, 0x804a000
    0x804901f ba01000000          <l1+21>          mov    edx, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    1...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x804900a in l1 (), reason: SINGLE STEP
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x804900a → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤
.
.
.
gef➤  continue
Continuing.
9
Breakpoint 2, 0x08049033 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3a
$ebx   : 0x1
$ecx   : 0x1
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049033  →  <l1+41> loop 0x804900a <l1>
$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804902e 40                  <l1+36>          inc    eax
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
 →  0x8049033 e2d5                <l1+41>          loop   0x804900a <l1>
    0x8049035 b801000000          <l1+43>          mov    eax, 0x1
    0x804903a cd80                <l1+48>          int    0x80
    0x804903c 0000                                 add    BYTE PTR [eax], al
    0x804903e 0000                                 add    BYTE PTR [eax], al
    0x8049040 0000                                 add    BYTE PTR [eax], al
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    39 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    9...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049033 in l1 (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049033 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  stepi
0x08049035 in l1 ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3a
$ebx   : 0x1
$ecx   : 0x0
$edx   : 0x1
$esp   : 0xffffd430  →  0x00000001
$ebp   : 0x0
$esi   : 0x0
$edi   : 0x0
$eip   : 0x08049035  →  <l1+43> mov eax, 0x1
$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x00
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd430│+0x0000: 0x00000001   ← $esp
0xffffd434│+0x0004: 0xffffd5ad  →  "/root/box/loop"
0xffffd438│+0x0008: 0x00000000
0xffffd43c│+0x000c: 0xffffd5bc  →  0x5353454c
0xffffd440│+0x0010: 0xffffd5d1  →  "POWERSHELL_TELEMETRY_OPTOUT=1"
0xffffd444│+0x0014: 0xffffd5ef  →  "USER=root"
0xffffd448│+0x0018: 0xffffd5f9  →  "LANGUAGE=en_US:en"
0xffffd44c│+0x001c: 0xffffd60b  →  "SSH_CLIENT=192.168.181.1 50366 22"
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804902f 83c030              <l1+37>          add    eax, 0x30
    0x8049032 59                  <l1+40>          pop    ecx
    0x8049033 e2d5                <l1+41>          loop   0x804900a <l1>
 →  0x8049035 b801000000          <l1+43>          mov    eax, 0x1
    0x804903a cd80                <l1+48>          int    0x80
    0x804903c 0000                                 add    BYTE PTR [eax], al
    0x804903e 0000                                 add    BYTE PTR [eax], al
    0x8049040 0000                                 add    BYTE PTR [eax], al
    0x8049042 0000                                 add    BYTE PTR [eax], al
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <num+0000>    39 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    9...............
0x0804a010     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "loop", stopped 0x8049035 in l1 (), reason: SINGLE STEP
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049035 → l1()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤
```

## array.asm

```
INVENTORY   DW  0
            DW  0
            DW  0
            DW  0
            DW  0
            DW  0
            DW  0
            DW  0
```
```
INVENTORY   DW  0, 0 , 0 , 0 , 0 , 0 , 0 , 0
```
```
INVENTORY   TIMES 8 DW 0
```

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start   ;must be declared for linker (ld)
	
_start:	
 		
   mov  eax,3      ;number bytes to be summed 
   mov  ebx,0      ;EBX will store the sum
   mov  ecx, x     ;ECX will point to the current element to be summed

top:  add  ebx, [ecx]

   inc  ecx        ;move pointer to next element
   dec  eax        ;decrement counter
   jnz  top        ;if counter not 0, then loop again

done: 

   add  ebx, '0'
   mov  [sum], ebx ;done, store result in "sum"

display:

   mov  edx,1      ;message length
   mov  ecx, sum   ;message to write
   mov  ebx, 1     ;file descriptor (stdout)
   mov  eax, 4     ;system call number (sys_write)
   int  0x80       ;call kernel
	
   mov  eax, 1     ;system call number (sys_exit)
   int  0x80       ;call kernel

section	.data
global x
x:    
   db  2
   db  4
   db  3

sum: 
   db  0
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 array.asm
ld -m elf_i386 -o array array.o
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q array
Reading symbols from array...
(No debugging symbols found in array)
Error while writing index for `/root/box/array': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
$ecx   : 0x0
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 b803000000          <_start+0>       mov    eax, 0x3
    0x8049005 bb00000000          <_start+5>       mov    ebx, 0x0
    0x804900a b900a00408          <_start+10>      mov    ecx, 0x804a000
    0x804900f 0319                <top+0>          add    ebx, DWORD PTR [ecx]
    0x8049011 41                  <top+2>          inc    ecx
    0x8049012 48                  <top+3>          dec    eax
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  disassemble /r _start,+58
Dump of assembler code from 0x8049000 to 0x804903a:
=> 0x08049000 <_start+0>:       b8 03 00 00 00          mov    eax,0x3
   0x08049005 <_start+5>:       bb 00 00 00 00          mov    ebx,0x0
   0x0804900a <_start+10>:      b9 00 a0 04 08          mov    ecx,0x804a000
   0x0804900f <top+0>:  03 19                   add    ebx,DWORD PTR [ecx]
   0x08049011 <top+2>:  41                      inc    ecx
   0x08049012 <top+3>:  48                      dec    eax
   0x08049013 <top+4>:  75 fa                   jne    0x804900f <top>
   0x08049015 <done+0>: 83 c3 30                add    ebx,0x30
   0x08049018 <done+3>: 89 1d 03 a0 04 08       mov    DWORD PTR ds:0x804a003,ebx
   0x0804901e <display+0>:      ba 01 00 00 00          mov    edx,0x1
   0x08049023 <display+5>:      b9 03 a0 04 08          mov    ecx,0x804a003
   0x08049028 <display+10>:     bb 01 00 00 00          mov    ebx,0x1
   0x0804902d <display+15>:     b8 04 00 00 00          mov    eax,0x4
   0x08049032 <display+20>:     cd 80                   int    0x80
   0x08049034 <display+22>:     b8 01 00 00 00          mov    eax,0x1
   0x08049039 <display+27>:     cd 80                   int    0x80
End of assembler dump.
gef➤  b *top
Breakpoint 1 at 0x804900f
gef➤  memory watch 0x804a000 32 byte
[+] Adding memwatch to 0x804a000
gef➤  context memory
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <x+0000>    02 04 03 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a010     00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00    ................
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.

Breakpoint 1, 0x0804900f in top ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3
$ebx   : 0x0
$ecx   : 0x0804a000  →  <x+0> add al, BYTE PTR [ebx+eax*1]
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 b803000000          <_start+0>       mov    eax, 0x3
    0x8049005 bb00000000          <_start+5>       mov    ebx, 0x0
    0x804900a b900a00408          <_start+10>      mov    ecx, 0x804a000
 →  0x804900f 0319                <top+0>          add    ebx, DWORD PTR [ecx]
    0x8049011 41                  <top+2>          inc    ecx
    0x8049012 48                  <top+3>          dec    eax
    0x8049013 75fa                <top+4>          jne    0x804900f <top>
    0x8049015 83c330              <done+0>         add    ebx, 0x30
    0x8049018 891d03a00408        <done+3>         mov    DWORD PTR ds:0x804a003, ebx
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <x+0000>    02 04 03 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a010     00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 1, 0x0804900f in top ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x2
$ebx   : 0x30402
$ecx   : 0x0804a001  →  <x+1> add al, 0x3
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 b803000000          <_start+0>       mov    eax, 0x3
    0x8049005 bb00000000          <_start+5>       mov    ebx, 0x0
    0x804900a b900a00408          <_start+10>      mov    ecx, 0x804a000
 →  0x804900f 0319                <top+0>          add    ebx, DWORD PTR [ecx]
    0x8049011 41                  <top+2>          inc    ecx
    0x8049012 48                  <top+3>          dec    eax
    0x8049013 75fa                <top+4>          jne    0x804900f <top>
    0x8049015 83c330              <done+0>         add    ebx, 0x30
    0x8049018 891d03a00408        <done+3>         mov    DWORD PTR ds:0x804a003, ebx
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <x+0000>    02 04 03 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a010     00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 1, 0x0804900f in top ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x1
$ebx   : 0x30706
$ecx   : 0x0804a002  →  <x+2> add eax, DWORD PTR [eax]
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 b803000000          <_start+0>       mov    eax, 0x3
    0x8049005 bb00000000          <_start+5>       mov    ebx, 0x0
    0x804900a b900a00408          <_start+10>      mov    ecx, 0x804a000
 →  0x804900f 0319                <top+0>          add    ebx, DWORD PTR [ecx]
    0x8049011 41                  <top+2>          inc    ecx
    0x8049012 48                  <top+3>          dec    eax
    0x8049013 75fa                <top+4>          jne    0x804900f <top>
    0x8049015 83c330              <done+0>         add    ebx, 0x30
    0x8049018 891d03a00408        <done+3>         mov    DWORD PTR ds:0x804a003, ebx
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <x+0000>    02 04 03 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a010     00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  b *display
Breakpoint 2 at 0x804901e
gef➤  continue
Continuing.

Breakpoint 2, 0x0804901e in display ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x30739
$ecx   : 0x0804a003  →  <sum+0> cmp DWORD PTR [edi], eax
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049013 75fa                <top+4>          jne    0x804900f <top>
    0x8049015 83c330              <done+0>         add    ebx, 0x30
    0x8049018 891d03a00408        <done+3>         mov    DWORD PTR ds:0x804a003, ebx
 →  0x804901e ba01000000          <display+0>      mov    edx, 0x1
    0x8049023 b903a00408          <display+5>      mov    ecx, 0x804a003
    0x8049028 bb01000000          <display+10>     mov    ebx, 0x1
    0x804902d b804000000          <display+15>     mov    eax, 0x4
    0x8049032 cd80                <display+20>     int    0x80
    0x8049034 b801000000          <display+22>     mov    eax, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <x+0000>    02 04 03 39 07 03 00 00 00 00 00 00 00 00 00 00    ...9............
0x0804a010     00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.
9[Inferior 1 (process 2042413) exited with code 01]
gef➤
```

## printable.asm

```
proc_name:
   procedure body
   ...
   ret

CALL proc_name
```

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start        ;must be declared for using gcc
	
_start:	                ;tell linker entry point
   call  display
   mov   eax,1	        ;system call number (sys_exit)
   int   0x80	        ;call kernel
	
display:
   mov   ecx, 79
	
next:
   push  ecx
   mov   eax, 4
   mov   ebx, 1
   mov   ecx, achar
   mov   edx, 1
   int   80h
	
   pop   ecx	
   mov   dx, [achar]
   inc   byte [achar]
   loop  next
   ret
	
section .data
achar db '0'
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 printable.asm
ld -m elf_i386 -o printable printable.o
./printable
0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~
```

## factorial.asm

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start         ;must be declared for using gcc
	
_start:                  ;tell linker entry point

   mov bx, 3             ;for calculating factorial 3
   call  proc_fact
   add   ax, 30h
   mov  [fact], ax
    
   mov	  edx,len        ;message length
   mov	  ecx,msg        ;message to write
   mov	  ebx,1          ;file descriptor (stdout)
   mov	  eax,4          ;system call number (sys_write)
   int	  0x80           ;call kernel

   mov   edx,1            ;message length
   mov	  ecx,fact       ;message to write
   mov	  ebx,1          ;file descriptor (stdout)
   mov	  eax,4          ;system call number (sys_write)
   int	  0x80           ;call kernel
    
   mov	  eax,1          ;system call number (sys_exit)
   int	  0x80           ;call kernel
	
proc_fact:
   cmp   bl, 1
   jg    do_calculation
   mov   ax, 1
   ret
	
do_calculation:
   dec   bl
   call  proc_fact
   inc   bl
   mul   bl        ;ax = al * bl
   ret

section	.data
msg db 'Factorial 3 is: '
len equ $ - msg			

section .bss
fact resb 1
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 factorial.asm
ld -m elf_i386 -o factorial factorial.o
./factorial
Factorial 3 is: 6
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q factorial
Reading symbols from factorial...
(No debugging symbols found in factorial)
sError while writing index for `/root/box/factorial': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd420│+0x0000: 0x00000001   ← $esp
0xffffd424│+0x0004: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0008: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 66bb0300            <_start+0>       mov    bx, 0x3
    0x8049004 e83d000000          <_start+4>       call   0x8049046 <proc_fact>
    0x8049009 6683c030            <_start+9>       add    ax, 0x30
    0x804900d 66a310a00408        <_start+13>      mov    ds:0x804a010, ax
    0x8049013 ba10000000          <_start+19>      mov    edx, 0x10
    0x8049018 b900a00408          <_start+24>      mov    ecx, 0x804a000
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  disassemble /r _start,+92
Dump of assembler code from 0x8049000 to 0x804905c:
=> 0x08049000 <_start+0>:       66 bb 03 00             mov    bx,0x3
   0x08049004 <_start+4>:       e8 3d 00 00 00          call   0x8049046 <proc_fact>
   0x08049009 <_start+9>:       66 83 c0 30             add    ax,0x30
   0x0804900d <_start+13>:      66 a3 10 a0 04 08       mov    ds:0x804a010,ax
   0x08049013 <_start+19>:      ba 10 00 00 00          mov    edx,0x10
   0x08049018 <_start+24>:      b9 00 a0 04 08          mov    ecx,0x804a000
   0x0804901d <_start+29>:      bb 01 00 00 00          mov    ebx,0x1
   0x08049022 <_start+34>:      b8 04 00 00 00          mov    eax,0x4
   0x08049027 <_start+39>:      cd 80                   int    0x80
   0x08049029 <_start+41>:      ba 01 00 00 00          mov    edx,0x1
   0x0804902e <_start+46>:      b9 10 a0 04 08          mov    ecx,0x804a010
   0x08049033 <_start+51>:      bb 01 00 00 00          mov    ebx,0x1
   0x08049038 <_start+56>:      b8 04 00 00 00          mov    eax,0x4
   0x0804903d <_start+61>:      cd 80                   int    0x80
   0x0804903f <_start+63>:      b8 01 00 00 00          mov    eax,0x1
   0x08049044 <_start+68>:      cd 80                   int    0x80
   0x08049046 <proc_fact+0>:    80 fb 01                cmp    bl,0x1
   0x08049049 <proc_fact+3>:    7f 05                   jg     0x8049050 <do_calculation>
   0x0804904b <proc_fact+5>:    66 b8 01 00             mov    ax,0x1
   0x0804904f <proc_fact+9>:    c3                      ret
   0x08049050 <do_calculation+0>:       fe cb                   dec    bl
   0x08049052 <do_calculation+2>:       e8 ef ff ff ff          call   0x8049046 <proc_fact>
   0x08049057 <do_calculation+7>:       fe c3                   inc    bl
   0x08049059 <do_calculation+9>:       f6 e3                   mul    bl
   0x0804905b <do_calculation+11>:      c3                      ret
End of assembler dump.
gef➤  b *_start+9
Breakpoint 1 at 0x8049009
gef➤  b *proc_fact+3
Breakpoint 2 at 0x8049049
gef➤  b *do_calculation+2
Breakpoint 3 at 0x8049052
gef➤  continue
Continuing.

Breakpoint 2, 0x08049049 in proc_fact ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x3
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd41c│+0x0000: 0x08049009  →  <_start+9> add ax, 0x30       ← $esp
0xffffd420│+0x0004: 0x00000001
0xffffd424│+0x0008: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x000c: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804903f b801000000          <_start+63>      mov    eax, 0x1
    0x8049044 cd80                <_start+68>      int    0x80
    0x8049046 80fb01              <proc_fact+0>    cmp    bl, 0x1
 →  0x8049049 7f05                <proc_fact+3>    jg     0x8049050 <do_calculation>    TAKEN [Reason: !Z && S==O]
   ↳   0x8049050 <do_calculation+0> dec    bl
       0x8049052 <do_calculation+2> call   0x8049046 <proc_fact>
       0x8049057 <do_calculation+7> inc    bl
       0x8049059 <do_calculation+9> mul    bl
       0x804905b <do_calculation+11> ret
       0x804905c                  add    BYTE PTR [eax], al
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
```

`CALL` thực hiện jump đến `0x08049046 <proc_fact+0>` và đẩy vào stack `0x08049009 <_start+9>` toạ độ của lệnh tiếp theo sau `call`.

```conf
gef➤  continue
Continuing.

Breakpoint 3, 0x08049052 in do_calculation ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x2
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd41c│+0x0000: 0x08049009  →  <_start+9> add ax, 0x30       ← $esp
0xffffd420│+0x0004: 0x00000001
0xffffd424│+0x0008: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x000c: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804904b 66b80100            <proc_fact+5>    mov    ax, 0x1
    0x804904f c3                  <proc_fact+9>    ret
    0x8049050 fecb                <do_calculation+0> dec    bl
 →  0x8049052 e8efffffff          <do_calculation+2> call   0x8049046 <proc_fact>
   ↳   0x8049046 <proc_fact+0>    cmp    bl, 0x1
       0x8049049 <proc_fact+3>    jg     0x8049050 <do_calculation>
       0x804904b <proc_fact+5>    mov    ax, 0x1
       0x804904f <proc_fact+9>    ret
       0x8049050 <do_calculation+0> dec    bl
       0x8049052 <do_calculation+2> call   0x8049046 <proc_fact>
─────────────────────────────────────────────────────────────────────────────────────── arguments (guessed) ────
...
gef➤  continue
Continuing.

Breakpoint 2, 0x08049049 in proc_fact ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x2
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd418│+0x0000: 0x08049057  →  <do_calculation+7> inc bl     ← $esp
0xffffd41c│+0x0004: 0x08049009  →  <_start+9> add ax, 0x30
0xffffd420│+0x0008: 0x00000001
0xffffd424│+0x000c: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0010: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804903f b801000000          <_start+63>      mov    eax, 0x1
    0x8049044 cd80                <_start+68>      int    0x80
    0x8049046 80fb01              <proc_fact+0>    cmp    bl, 0x1
 →  0x8049049 7f05                <proc_fact+3>    jg     0x8049050 <do_calculation>    TAKEN [Reason: !Z && S==O]
   ↳   0x8049050 <do_calculation+0> dec    bl
       0x8049052 <do_calculation+2> call   0x8049046 <proc_fact>
       0x8049057 <do_calculation+7> inc    bl
       0x8049059 <do_calculation+9> mul    bl
       0x804905b <do_calculation+11> ret
       0x804905c                  add    BYTE PTR [eax], al
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 3, 0x08049052 in do_calculation ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x1
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd418│+0x0000: 0x08049057  →  <do_calculation+7> inc bl     ← $esp
0xffffd41c│+0x0004: 0x08049009  →  <_start+9> add ax, 0x30
0xffffd420│+0x0008: 0x00000001
0xffffd424│+0x000c: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0010: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804904b 66b80100            <proc_fact+5>    mov    ax, 0x1
    0x804904f c3                  <proc_fact+9>    ret
    0x8049050 fecb                <do_calculation+0> dec    bl
 →  0x8049052 e8efffffff          <do_calculation+2> call   0x8049046 <proc_fact>
   ↳   0x8049046 <proc_fact+0>    cmp    bl, 0x1
       0x8049049 <proc_fact+3>    jg     0x8049050 <do_calculation>
       0x804904b <proc_fact+5>    mov    ax, 0x1
       0x804904f <proc_fact+9>    ret
       0x8049050 <do_calculation+0> dec    bl
       0x8049052 <do_calculation+2> call   0x8049046 <proc_fact>
─────────────────────────────────────────────────────────────────────────────────────── arguments (guessed) ────
...
gef➤  continue
Continuing.

Breakpoint 2, 0x08049049 in proc_fact ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x1
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd414│+0x0000: 0x08049057  →  <do_calculation+7> inc bl     ← $esp
0xffffd418│+0x0004: 0x08049057  →  <do_calculation+7> inc bl
0xffffd41c│+0x0008: 0x08049009  →  <_start+9> add ax, 0x30
0xffffd420│+0x000c: 0x00000001
0xffffd424│+0x0010: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0014: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804903f b801000000          <_start+63>      mov    eax, 0x1
    0x8049044 cd80                <_start+68>      int    0x80
    0x8049046 80fb01              <proc_fact+0>    cmp    bl, 0x1
 →  0x8049049 7f05                <proc_fact+3>    jg     0x8049050 <do_calculation>    NOT taken [Reason: !(!Z && S==O)]
    0x804904b 66b80100            <proc_fact+5>    mov    ax, 0x1
    0x804904f c3                  <proc_fact+9>    ret
    0x8049050 fecb                <do_calculation+0> dec    bl
    0x8049052 e8efffffff          <do_calculation+2> call   0x8049046 <proc_fact>
    0x8049057 fec3                <do_calculation+7> inc    bl
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  b *do_calculation+11
Breakpoint 4 at 0x804905b
gef➤  continue
Continuing.

Breakpoint 4, 0x0804905b in do_calculation ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x2
$ebx   : 0x2
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd418│+0x0000: 0x08049057  →  <do_calculation+7> inc bl     ← $esp
0xffffd41c│+0x0004: 0x08049009  →  <_start+9> add ax, 0x30
0xffffd420│+0x0008: 0x00000001
0xffffd424│+0x000c: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0010: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049052 e8efffffff          <do_calculation+2> call   0x8049046 <proc_fact>
    0x8049057 fec3                <do_calculation+7> inc    bl
    0x8049059 f6e3                <do_calculation+9> mul    bl
 →  0x804905b c3                  <do_calculation+11> ret
   ↳   0x8049057 <do_calculation+7> inc    bl
       0x8049059 <do_calculation+9> mul    bl
       0x804905b <do_calculation+11> ret
       0x804905c                  add    BYTE PTR [eax], al
       0x804905e                  add    BYTE PTR [eax], al
       0x8049060                  add    BYTE PTR [eax], al
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 4, 0x0804905b in do_calculation ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x6
$ebx   : 0x3
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd41c│+0x0000: 0x08049009  →  <_start+9> add ax, 0x30       ← $esp
0xffffd420│+0x0004: 0x00000001
0xffffd424│+0x0008: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x000c: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049052 e8efffffff          <do_calculation+2> call   0x8049046 <proc_fact>
    0x8049057 fec3                <do_calculation+7> inc    bl
    0x8049059 f6e3                <do_calculation+9> mul    bl
 →  0x804905b c3                  <do_calculation+11> ret
   ↳   0x8049009 <_start+9>       add    ax, 0x30
       0x804900d <_start+13>      mov    ds:0x804a010, ax
       0x8049013 <_start+19>      mov    edx, 0x10
       0x8049018 <_start+24>      mov    ecx, 0x804a000
       0x804901d <_start+29>      mov    ebx, 0x1
       0x8049022 <_start+34>      mov    eax, 0x4
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 1, 0x08049009 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x6
$ebx   : 0x3
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd420│+0x0000: 0x00000001   ← $esp
0xffffd424│+0x0004: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0008: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
    0x8049000 66bb0300            <_start+0>       mov    bx, 0x3
    0x8049004 e83d000000          <_start+4>       call   0x8049046 <proc_fact>
 →  0x8049009 6683c030            <_start+9>       add    ax, 0x30
    0x804900d 66a310a00408        <_start+13>      mov    ds:0x804a010, ax
    0x8049013 ba10000000          <_start+19>      mov    edx, 0x10
    0x8049018 b900a00408          <_start+24>      mov    ecx, 0x804a000
    0x804901d bb01000000          <_start+29>      mov    ebx, 0x1
    0x8049022 b804000000          <_start+34>      mov    eax, 0x4
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  stepi
0x0804900d in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x36
$ebx   : 0x3
...
───────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffd420│+0x0000: 0x00000001   ← $esp
0xffffd424│+0x0004: 0xffffd59e  →  "/root/box/factorial"
0xffffd428│+0x0008: 0x00000000
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049000 66bb0300            <_start+0>       mov    bx, 0x3
    0x8049004 e83d000000          <_start+4>       call   0x8049046 <proc_fact>
    0x8049009 6683c030            <_start+9>       add    ax, 0x30
 →  0x804900d 66a310a00408        <_start+13>      mov    ds:0x804a010, ax
    0x8049013 ba10000000          <_start+19>      mov    edx, 0x10
    0x8049018 b900a00408          <_start+24>      mov    ecx, 0x804a000
    0x804901d bb01000000          <_start+29>      mov    ebx, 0x1
    0x8049022 b804000000          <_start+34>      mov    eax, 0x4
    0x8049027 cd80                <_start+39>      int    0x80
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤
```

## macro.asm

```
%macro macro_name  number_of_params
<macro body>
%endmacro
```

{% capture code %}
{% highlight nasm linenos %}
; A macro with two parameters
; Implements the write system call
   %macro write_string 2 
      mov   eax, 4
      mov   ebx, 1
      mov   ecx, %1
      mov   edx, %2
      int   80h
   %endmacro
 
section	.text
   global _start            ;must be declared for using gcc
	
_start:                     ;tell linker entry point
   write_string msg1, len1               
   write_string msg2, len2    
   write_string msg3, len3  
	
   mov eax,1                ;system call number (sys_exit)
   int 0x80                 ;call kernel

section	.data
msg1 db	'Hello, programmers!',0xA,0xD 	
len1 equ $ - msg1			

msg2 db 'Welcome to the world of,',0xA,0xD 
len2 equ $- msg2 

msg3 db 'Linux assembly programming! '
len3 equ $- msg3
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 macro.asm
ld -m elf_i386 -o macro macro.o
./macro
Hello, programmers!
Welcome to the world of,
Linux assembly programming!
```

## file.asm

{% capture code %}
{% highlight nasm linenos %}
section	.text
   global _start           ;must be declared for using gcc
	
_start:                    ;tell linker entry point
   ; create the file
   mov  eax, 8             ;system call sys_creat() number 8 => EAX
   mov  ebx, file_name     ;filename => EBX
   mov  ecx, 0o644         ;644 = -rw-r--r--, file permissions => ECX (octal notation)
   int  0x80               ;call kernel
	
   mov [fd_out], eax       ;file descriptor/error <= EAX
    
   ; write into the file
   mov	eax, 4            ;system call sys_write() number 4 => EAX
   mov	ebx, [fd_out]     ;file descriptor => EBX
   mov	ecx, msg          ;message to write => ECX
   mov	edx, len          ;number of bytes to write => EDX
   int	0x80              ;call kernel
	
   ; close the file
   mov eax, 6              ;system call sys_close() number 6 => EAX
   mov ebx, [fd_out]       ;file descriptor => EBX
   int 0x80                ;call kernel
    
   ; write the message indicating end of file write
   mov eax, 4              
   mov ebx, 1              
   mov ecx, msg_done       
   mov edx, len_done       
   int 0x80
    
   ; open the file for reading
   mov eax, 5              ;sys_open() number 5 => EAX
   mov ebx, file_name      ;filename => EBX register
   mov ecx, 0              ;access mode (read-only:0, write-only:1, read-write:2) => ECX
   mov edx, 0o644          ;644 = -rw-r--r--, file permissions => ECX (octal notation)
   int 0x80                ;call kernel
	
   mov  [fd_in], eax
    
   ; read from file
   mov eax, 3              ;system call sys_read() number 3 => EAX
   mov ebx, [fd_in]        ;file descriptor => EBX
   mov ecx, content        ;pointer to the input buffer => ECX
   mov edx, 26             ;buffer size, i.e., the number of bytes to read => EDX
   int 0x80                ;call kernel
    
   ; close the file
   mov eax, 6              ;system call sys_close() number 6 => EAX
   mov ebx, [fd_in]        ;file descriptor => EBX
   int 0x80                ;call kernel
	
   ; print the content of file 
   mov eax, 4
   mov ebx, 1
   mov ecx, content
   mov edx, 26
   int 0x80                ;call kernel

   ; exit    
   mov	eax,1             ;system call number (sys_exit)
   int	0x80              ;call kernel

section	.data
file_name db 'myfile.txt', 0x0         ;0x0 to stop read filename
msg db 'Welcome to Tutorials Point'
len equ  $-msg

msg_done db 'Written to file', 0xa
len_done equ $-msg_done

section .bss
fd_out resb 1
fd_in  resb 1
content resb  26
{% endhighlight %}
{% endcapture %}
{% include fix_linenos.html code=code %}
{% assign code = nil %}

Biên dịch chương trình:

```
nasm -f elf32 file.asm
ld -m elf_i386 -o file file.o
./file
```

Dùng __gef__ debug:

```conf
┌──(root㉿kali)-[~/box]
└─# gdb-gef -q file
Reading symbols from file...
(No debugging symbols found in file)
Error while writing index for `/root/box/file': No debugging symbols
GEF for linux ready, type `gef' to start, `gef config' to configure
89 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  start
[+] Breaking at '0x8049000'
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x0
$ecx   : 0x0
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8048ffa 0000                                 add    BYTE PTR [eax], al
    0x8048ffc 0000                                 add    BYTE PTR [eax], al
    0x8048ffe 0000                                 add    BYTE PTR [eax], al
 →  0x8049000 b808000000          <_start+0>       mov    eax, 0x8
    0x8049005 bb00a00408          <_start+5>       mov    ebx, 0x804a000
    0x804900a b9a4010000          <_start+10>      mov    ecx, 0x1a4
    0x804900f cd80                <_start+15>      int    0x80
    0x8049011 a338a00408          <_start+17>      mov    ds:0x804a038, eax
    0x8049016 b804000000          <_start+22>      mov    eax, 0x4
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  disassemble /r _start,+172
Dump of assembler code from 0x8049000 to 0x80490ac:
=> 0x08049000 <_start+0>:       b8 08 00 00 00          mov    eax,0x8
   0x08049005 <_start+5>:       bb 00 a0 04 08          mov    ebx,0x804a000
   0x0804900a <_start+10>:      b9 a4 01 00 00          mov    ecx,0x1a4
   0x0804900f <_start+15>:      cd 80                   int    0x80
   0x08049011 <_start+17>:      a3 38 a0 04 08          mov    ds:0x804a038,eax
   0x08049016 <_start+22>:      b8 04 00 00 00          mov    eax,0x4
   0x0804901b <_start+27>:      8b 1d 38 a0 04 08       mov    ebx,DWORD PTR ds:0x804a038
   0x08049021 <_start+33>:      b9 0b a0 04 08          mov    ecx,0x804a00b
   0x08049026 <_start+38>:      ba 1a 00 00 00          mov    edx,0x1a
   0x0804902b <_start+43>:      cd 80                   int    0x80
   0x0804902d <_start+45>:      b8 06 00 00 00          mov    eax,0x6
   0x08049032 <_start+50>:      8b 1d 38 a0 04 08       mov    ebx,DWORD PTR ds:0x804a038
   0x08049038 <_start+56>:      cd 80                   int    0x80
   0x0804903a <_start+58>:      b8 04 00 00 00          mov    eax,0x4
   0x0804903f <_start+63>:      bb 01 00 00 00          mov    ebx,0x1
   0x08049044 <_start+68>:      b9 25 a0 04 08          mov    ecx,0x804a025
   0x08049049 <_start+73>:      ba 10 00 00 00          mov    edx,0x10
   0x0804904e <_start+78>:      cd 80                   int    0x80
   0x08049050 <_start+80>:      b8 05 00 00 00          mov    eax,0x5
   0x08049055 <_start+85>:      bb 00 a0 04 08          mov    ebx,0x804a000
   0x0804905a <_start+90>:      b9 00 00 00 00          mov    ecx,0x0
   0x0804905f <_start+95>:      ba a4 01 00 00          mov    edx,0x1a4
   0x08049064 <_start+100>:     cd 80                   int    0x80
   0x08049066 <_start+102>:     a3 39 a0 04 08          mov    ds:0x804a039,eax
   0x0804906b <_start+107>:     b8 03 00 00 00          mov    eax,0x3
   0x08049070 <_start+112>:     8b 1d 39 a0 04 08       mov    ebx,DWORD PTR ds:0x804a039
   0x08049076 <_start+118>:     b9 3a a0 04 08          mov    ecx,0x804a03a
   0x0804907b <_start+123>:     ba 1a 00 00 00          mov    edx,0x1a
   0x08049080 <_start+128>:     cd 80                   int    0x80
   0x08049082 <_start+130>:     b8 06 00 00 00          mov    eax,0x6
   0x08049087 <_start+135>:     8b 1d 39 a0 04 08       mov    ebx,DWORD PTR ds:0x804a039
   0x0804908d <_start+141>:     cd 80                   int    0x80
   0x0804908f <_start+143>:     b8 04 00 00 00          mov    eax,0x4
   0x08049094 <_start+148>:     bb 01 00 00 00          mov    ebx,0x1
   0x08049099 <_start+153>:     b9 3a a0 04 08          mov    ecx,0x804a03a
   0x0804909e <_start+158>:     ba 1a 00 00 00          mov    edx,0x1a
   0x080490a3 <_start+163>:     cd 80                   int    0x80
   0x080490a5 <_start+165>:     b8 01 00 00 00          mov    eax,0x1
   0x080490aa <_start+170>:     cd 80                   int    0x80
End of assembler dump.
gef➤  memory watch 0x804a000 128 byte
[+] Adding memwatch to 0x804a000
gef➤  b *_start+17
Breakpoint 1 at 0x8049011
gef➤  b *_start+45
Breakpoint 2 at 0x804902d
gef➤  b *_start+58
Breakpoint 3 at 0x804903a
gef➤  b *_start+102
Breakpoint 4 at 0x8049066
gef➤  b *_start+130
Breakpoint 6 at 0x8049082
gef➤  b *_start+143
Breakpoint 7 at 0x804908f
gef➤  b *_start+165
Breakpoint 8 at 0x80490a5
gef➤  continue
Continuing.

Breakpoint 1, 0x08049011 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3
$ebx   : 0x0804a000  →  "myfile.txt"
$ecx   : 0x1a4
$edx   : 0x0
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049005 bb00a00408          <_start+5>       mov    ebx, 0x804a000
    0x804900a b9a4010000          <_start+10>      mov    ecx, 0x1a4
    0x804900f cd80                <_start+15>      int    0x80
 →  0x8049011 a338a00408          <_start+17>      mov    ds:0x804a038, eax
    0x8049016 b804000000          <_start+22>      mov    eax, 0x4
    0x804901b 8b1d38a00408        <_start+27>      mov    ebx, DWORD PTR ds:0x804a038
    0x8049021 b90ba00408          <_start+33>      mov    ecx, 0x804a00b
    0x8049026 ba1a000000          <_start+38>      mov    edx, 0x1a
    0x804902b cd80                <_start+43>      int    0x80
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 00 00 00 00 00 00 00 00    file............
0x0804a040 <content+0006>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a050 <content+0016>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "file", stopped 0x8049011 in _start (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049011 → _start()
────────────────────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  continue
Continuing.

Breakpoint 2, 0x0804902d in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x1a
$ebx   : 0x3
$ecx   : 0x0804a00b  →  "Welcome to Tutorials PointWritten to file\n"
$edx   : 0x1a
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049021 b90ba00408          <_start+33>      mov    ecx, 0x804a00b
    0x8049026 ba1a000000          <_start+38>      mov    edx, 0x1a
    0x804902b cd80                <_start+43>      int    0x80
 →  0x804902d b806000000          <_start+45>      mov    eax, 0x6
    0x8049032 8b1d38a00408        <_start+50>      mov    ebx, DWORD PTR ds:0x804a038
    0x8049038 cd80                <_start+56>      int    0x80
    0x804903a b804000000          <_start+58>      mov    eax, 0x4
    0x804903f bb01000000          <_start+63>      mov    ebx, 0x1
    0x8049044 b925a00408          <_start+68>      mov    ecx, 0x804a025
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 00 00 00 00 00 00 00    file............
0x0804a040 <content+0006>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a050 <content+0016>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 3, 0x0804903a in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x0
$ebx   : 0x3
$ecx   : 0x0804a00b  →  "Welcome to Tutorials PointWritten to file\n"
$edx   : 0x1a
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804902d b806000000          <_start+45>      mov    eax, 0x6
    0x8049032 8b1d38a00408        <_start+50>      mov    ebx, DWORD PTR ds:0x804a038
    0x8049038 cd80                <_start+56>      int    0x80
 →  0x804903a b804000000          <_start+58>      mov    eax, 0x4
    0x804903f bb01000000          <_start+63>      mov    ebx, 0x1
    0x8049044 b925a00408          <_start+68>      mov    ecx, 0x804a025
    0x8049049 ba10000000          <_start+73>      mov    edx, 0x10
    0x804904e cd80                <_start+78>      int    0x80
    0x8049050 b805000000          <_start+80>      mov    eax, 0x5
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 00 00 00 00 00 00 00    file............
0x0804a040 <content+0006>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a050 <content+0016>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.
Written to file

Breakpoint 4, 0x08049066 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x3
$ebx   : 0x0804a000  →  "myfile.txt"
$ecx   : 0x0
$edx   : 0x1a4
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x804905a b900000000          <_start+90>      mov    ecx, 0x0
    0x804905f baa4010000          <_start+95>      mov    edx, 0x1a4
    0x8049064 cd80                <_start+100>     int    0x80
 →  0x8049066 a339a00408          <_start+102>     mov    ds:0x804a039, eax
    0x804906b b803000000          <_start+107>     mov    eax, 0x3
    0x8049070 8b1d39a00408        <_start+112>     mov    ebx, DWORD PTR ds:0x804a039
    0x8049076 b93aa00408          <_start+118>     mov    ecx, 0x804a03a
    0x804907b ba1a000000          <_start+123>     mov    edx, 0x1a
    0x8049080 cd80                <_start+128>     int    0x80
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 00 00 00 00 00 00 00    file............
0x0804a040 <content+0006>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a050 <content+0016>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 6, 0x08049082 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x1a
$ebx   : 0x3
$ecx   : 0x0804a03a  →  "Welcome to Tutorials Point"
$edx   : 0x1a
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049076 b93aa00408          <_start+118>     mov    ecx, 0x804a03a
    0x804907b ba1a000000          <_start+123>     mov    edx, 0x1a
    0x8049080 cd80                <_start+128>     int    0x80
 →  0x8049082 b806000000          <_start+130>     mov    eax, 0x6
    0x8049087 8b1d39a00408        <_start+135>     mov    ebx, DWORD PTR ds:0x804a039
    0x804908d cd80                <_start+141>     int    0x80
    0x804908f b804000000          <_start+143>     mov    eax, 0x4
    0x8049094 bb01000000          <_start+148>     mov    ebx, 0x1
    0x8049099 b93aa00408          <_start+153>     mov    ecx, 0x804a03a
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 03 57 65 6c 63 6f 6d    file......Welcom
0x0804a040 <content+0006>    65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20 50    e to Tutorials P
0x0804a050 <content+0016>    6f 69 6e 74 00 00 00 00 00 00 00 00 00 00 00 00    oint............
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.

Breakpoint 7, 0x0804908f in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xfffffff7
$ebx   : 0x6c655703
$ecx   : 0x0804a03a  →  "Welcome to Tutorials Point"
$edx   : 0x1a
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049082 b806000000          <_start+130>     mov    eax, 0x6
    0x8049087 8b1d39a00408        <_start+135>     mov    ebx, DWORD PTR ds:0x804a039
    0x804908d cd80                <_start+141>     int    0x80
 →  0x804908f b804000000          <_start+143>     mov    eax, 0x4
    0x8049094 bb01000000          <_start+148>     mov    ebx, 0x1
    0x8049099 b93aa00408          <_start+153>     mov    ecx, 0x804a03a
    0x804909e ba1a000000          <_start+158>     mov    edx, 0x1a
    0x80490a3 cd80                <_start+163>     int    0x80
    0x80490a5 b801000000          <_start+165>     mov    eax, 0x1
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 03 57 65 6c 63 6f 6d    file......Welcom
0x0804a040 <content+0006>    65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20 50    e to Tutorials P
0x0804a050 <content+0016>    6f 69 6e 74 00 00 00 00 00 00 00 00 00 00 00 00    oint............
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤  continue
Continuing.
Welcome to Tutorials Point
Breakpoint 8, 0x080490a5 in _start ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x1a
$ebx   : 0x1
$ecx   : 0x0804a03a  →  "Welcome to Tutorials Point"
$edx   : 0x1a
...
─────────────────────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049099 b93aa00408          <_start+153>     mov    ecx, 0x804a03a
    0x804909e ba1a000000          <_start+158>     mov    edx, 0x1a
    0x80490a3 cd80                <_start+163>     int    0x80
 →  0x80490a5 b801000000          <_start+165>     mov    eax, 0x1
    0x80490aa cd80                <_start+170>     int    0x80
    0x80490ac 0000                                 add    BYTE PTR [eax], al
    0x80490ae 0000                                 add    BYTE PTR [eax], al
    0x80490b0 0000                                 add    BYTE PTR [eax], al
    0x80490b2 0000                                 add    BYTE PTR [eax], al
────────────────────────────────────────────────────────────────────────────────────────── memory:0x804a000 ────
0x0804a000 <file_name+0000>    6d 79 66 69 6c 65 2e 74 78 74 00 57 65 6c 63 6f    myfile.txt.Welco
0x0804a010 <msg+0005>    6d 65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20    me to Tutorials
0x0804a020 <msg+0015>    50 6f 69 6e 74 57 72 69 74 74 65 6e 20 74 6f 20    PointWritten to
0x0804a030 <msg_done+000b>    66 69 6c 65 0a 00 00 00 03 03 57 65 6c 63 6f 6d    file......Welcom
0x0804a040 <content+0006>    65 20 74 6f 20 54 75 74 6f 72 69 61 6c 73 20 50    e to Tutorials P
0x0804a050 <content+0016>    6f 69 6e 74 00 00 00 00 00 00 00 00 00 00 00 00    oint............
0x0804a060     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
0x0804a070     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
─────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
...
gef➤
```



